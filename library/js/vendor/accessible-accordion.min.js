/**
 * --------------------------------------------------------------------
 * jQuery accessible accordion plugin
 * Author: Alexey Novak <alexey.novak.mail@gmail.com>
 * Copyright (c) 2016 Alexey Novak
 * URL: https://github.com/anvk/a11yAccordion
 * licensed under MIT (https://github.com/anvk/a11yAccordion/blob/master/LICENSE)
 * --------------------------------------------------------------------
 */

"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _extends=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),A11yAccordion=function(a){function b(){var a=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];_classCallCheck(this,b);var c={SEARCH_ACTION_TYPE_HIDE:"hide",SEARCH_ACTION_TYPE_COLLAPSE:"collapse"};this.collapseRow=this.collapseRow.bind(this),this.uncollapseRow=this.uncollapseRow.bind(this),this.toggleRow=this.toggleRow.bind(this),this.getRowEl=this.getRowEl.bind(this),this._render=this._render.bind(this),this._renderSearch=this._renderSearch.bind(this),this._collapseWork=this._collapseWork.bind(this),this._collapseAll=this._collapseAll.bind(this),this._collapse=this._collapse.bind(this),this._uncollapse=this._uncollapse.bind(this),this._getHiddenArea=this._getHiddenArea.bind(this),this._traverseChildNodes=this._traverseChildNodes.bind(this);var d={constants:c,parentSelector:void 0,hideEffectStyle:"linear",speed:300,hiddenLinkDescription:"",showSearch:!0,showOne:!0,searchActionType:c.SEARCH_ACTION_TYPE_HIDE,overallSearch:!1,onAreaShow:function(){},onAreaHide:function(){},classes:{headerClass:"a11yAccordionItemHeader",accordionItemClass:"a11yAccordionItem",hiddenAreaClass:"a11yAccordionHideArea",showHeaderLabelClass:"a11yAccordionItemHeaderLinkShowLabel",hideHeaderLabelClass:"a11yAccordionItemHeaderLinkHideLabel",markedTextClass:"a11yAccordion-markedText",visibleAreaClass:"visiblea11yAccordionItem",noResultsDivClass:"a11yAccordionNoResultsItem",searchDivClass:"a11yAccordionSearchDiv",headerLinkClass:"a11yAccordionItemHeaderLink",headerTextClass:"a11yAccordionItemHeaderText",hiddenHeaderLabelDescriptionClass:"a11yAccordionItemHeaderLinkHiddenLabel",toggleClass:"toggle",triangleClass:"a11yAccordion-triangle",searchClass:"a11yAccordionSearch",accordionHeaderClass:"a11yAccordion-header",accordionHideAreaClass:"a11yAccordion-area"},labels:{showHeaderLabelText:"Show",hideHeaderLabelText:"Hide",searchPlaceholder:"Search",noResultsText:"No Results Found",titleText:"Type your query to search",resultsMessage:"Number of results found: ",leaveBlankMessage:" Please leave blank to see all the results."},ids:{noResultsDivID:"a11yAccordion-noResultsItem",searchDivID:"a11yAccordion-searchPanel",rowIdStringPrefix:"a11yAccordion-row-"}};a=_extends({},d,a);var e=a,f=e.classes;a=_extends({},a,{selectors:{triangleSelector:"."+f.triangleClass,visibleAreaSelector:"."+f.visibleAreaClass,markedTextSelector:"."+f.markedTextClass,headerLinkSelector:"."+f.headerLinkClass,headerSelector:"."+f.headerClass,showHeaderLabelSelector:"."+f.showHeaderLabelClass,hideHeaderLabelSelector:"."+f.hideHeaderLabelClass,accordionItemSelector:"."+f.accordionItemClass,hiddenAreaSelector:"."+f.hiddenAreaClass}}),this.props=a,this._render()}return _createClass(b,[{key:"collapseRow",value:function(b){(0,this._collapse)((0,this._getHiddenArea)(b))}},{key:"uncollapseRow",value:function(b){(0,this._uncollapse)((0,this._getHiddenArea)(b))}},{key:"toggleRow",value:function(b){(0,this._collapseWork)((0,this._getHiddenArea)(b))}},{key:"getRowEl",value:function(c){var d=this.refs,e=d.accordionHideAreas,f=d.accordionItems;return c>=0&&c<e.length?a(f[c]):void 0}},{key:"_render",value:function(){var c=this.props,d=this._collapseWork,e=c.parentSelector,f=c.hiddenLinkDescription,j=(c.onAreaShow,c.onAreaHide,c.speed,c.showSearch),k=c.searchActionType,l=c.classes,m=c.labels,n=c.selectors,o=c.constants,q=(l.visibleAreaClass,l.headerLinkClass),r=l.headerTextClass,s=l.hiddenHeaderLabelDescriptionClass,u=(l.toggleClass,l.triangleClass),v=l.accordionHeaderClass,w=l.accordionHideAreaClass,x=l.showHeaderLabelClass,y=l.hideHeaderLabelClass,z=m.showHeaderLabelText,A=m.hideHeaderLabelText,D=(n.showHeaderLabelSelector,n.hideHeaderLabelSelector,n.headerSelector),E=n.headerLinkSelector,F=n.accordionItemSelector,G=n.hiddenAreaSelector,H=a(e),I=H.find("> "+F),J=I.find("> "+G),K=I.find("> "+D);if(this.refs={el:H,accordionItems:I,accordionHideAreas:J,headers:K},!H.length)throw"a11yAccordion - no element(s) with parentSelector was found";if(!I.length)throw"a11yAccordion - no element(s) with accordionItemSelector was found";if(!K.length)throw"a11yAccordion - no element(s) with headerSelector was found";if(!J.length)throw"a11yAccordion - no element(s) with hiddenAreaSelector was found";if(k!==o.SEARCH_ACTION_TYPE_HIDE&&k!==o.SEARCH_ACTION_TYPE_COLLAPSE)throw"a11yAccordion - invalid searchActionType. It can only be: "+o.SEARCH_ACTION_TYPE_HIDE+" or "+o.SEARCH_ACTION_TYPE_COLLAPSE;J.hide(),K.addClass(v),J.addClass(w);var L=function(c){c.preventDefault(),c.stopPropagation();var e=a(c.target).parents(F).eq(0);d(e.find("> "+G).eq(0)),e.find(E).eq(0).focus()};K.click(L),a.each(K,function(c,d){var e=[],g=a("<a>",{href:"#",class:q});g.click(L),e.push(a("<span>",{text:z,class:x})),e.push(a("<span>",{text:A,style:"display: none;",class:y})),e.push(a("<span>",{text:f,class:s})),e.push(a("<div>",{class:u})),a(d).wrapInner('<span class="'+r+'"></span>'),g.prepend(e).appendTo(d)}),j&&this._renderSearch()}},{key:"_renderSearch",value:function(){var c=this.refs,d=this.props,e=this.collapseRow,f=this.uncollapseRow,g=this._traverseChildNodes,h=this._getHiddenArea,i=d.overallSearch,j=d.classes,k=d.ids,l=d.labels,m=d.selectors,n=d.searchActionType,o=d.constants,p=c.el,q=c.accordionItems,r=c.accordionHideAreas,s=c.headers,t=k.noResultsDivID,u=k.searchDivID,v=k.rowIdStringPrefix,w=j.markedTextClass,x=j.noResultsDivClass,y=j.searchDivClass,z=j.searchClass,A=j.accordionHeaderClass,B=j.headerClass,C=l.searchPlaceholder,D=l.noResultsText,E=l.titleText,F=l.resultsMessage,G=l.leaveBlankMessage,H=m.markedTextSelector,J=(m.headerSelector,a("<div>",{id:u,class:y})),K=a("<input>",{type:"text",placeholder:C,class:z,title:E}).appendTo(J),L=a("<li>",{class:x,id:t,style:"display:none;"}).appendTo(p);a("<div>",{class:B+" "+A,text:D}).appendTo(L),q.each(function(b,c){c.setAttribute("id",v+b)}),J.prependTo(p);var M="";K.keyup(function(b){var c=b.target.value,d=c.toLowerCase();if(M!==d){M=d,L.hide();for(var l,j=new RegExp(d,"ig"),k=0;k<q.length;k++){var m=s[k].children[0];if(a(m).find(H).each(function(b,c){return a(c).contents().unwrap()}),m.normalize(),l=!d.length||g(m,j,w),i){var p=r[k];a(p).find(H).each(function(b,c){return a(c).contents().unwrap()}),p.normalize(),l=!(d.length&&!l)||g(p,j,w)}if(n===o.SEARCH_ACTION_TYPE_HIDE)a(q[k])[l?"show":"hide"]();else if(n===o.SEARCH_ACTION_TYPE_COLLAPSE){var t=h(k),u=t[0].style.display;d.length||"block"!==u?"none"===u&&l?f(k):"block"!==u||l||e(k):e(k)}}var v=r.filter(":visible").length;K.attr("title",F+v.toString()+G),v||L.show()}})}},{key:"_collapseWork",value:function(b){var c=this.props.classes,d=c.visibleAreaClass;b&&this[b.hasClass(d)?"_collapse":"_uncollapse"](b)}},{key:"_collapseAll",value:function(){var c=this.refs,d=this.props,e=this._collapse,f=d.selectors.visibleAreaSelector,g=c.accordionHideAreas,h=g.filter(f);a.each(h,function(a,b){return e(b)})}},{key:"_collapse",value:function(c){var d=this.props,e=d.onAreaHide,f=d.speed,g=d.classes,h=d.selectors,i=d.hideEffectStyle,j=g.toggleClass,k=g.visibleAreaClass,l=h.headerSelector,m=h.showHeaderLabelSelector,n=h.hideHeaderLabelSelector,o=h.triangleSelector;if(c=a(c),c.length&&c.hasClass(k)){var p=c.siblings(l);p.find(m).show(),p.find(n).hide(),p.find(o).toggleClass(j),c.prev().removeClass("open"),c.slideUp(f,i,function(){c.removeClass(k),c.hide(),e(c)})}}},{key:"_uncollapse",value:function(c){var d=this.props,e=this._collapseAll,f=d.onAreaShow,g=d.speed,h=d.classes,i=d.selectors,j=d.hideEffectStyle,k=d.showOne,l=h.toggleClass,m=h.visibleAreaClass,n=i.headerSelector,o=i.showHeaderLabelSelector,p=i.hideHeaderLabelSelector,q=i.triangleSelector;if(c=a(c),c.length&&!c.hasClass(m)){k&&e(c);var r=c.siblings(n);r.find(o).hide(),r.find(p).show(),r.find(q).toggleClass(l),c.addClass(m),c.prev().addClass("open"),c.slideDown(g,j,function(){c.show(),f(c)})}}},{key:"_getHiddenArea",value:function(c){var d=this.refs.accordionHideAreas;return c>=0&&c<d.length?a(d[c]):void 0}},{key:"_traverseChildNodes",value:function(c,d,e){var f=this;if(3===c.nodeType&&d.test(c.data)){if(c.textContent.match(d)){var g=document.createElement("div");for(g.innerHTML=c.data.replace(d,'<mark class="'+e+'">$&</mark>');g.firstChild;)c.parentNode.insertBefore(g.firstChild,c);return c.parentNode.removeChild(c),!0}}else{var h=c.childNodes;if(h.length){var i=void 0;return a(h).each(function(a,b){i=f._traverseChildNodes(b,d,e)||i}),i}}}}]),b}(jQuery);!function(a){var b=new A11yAccordion({parentSelector:".a11yAccordion",showSearch:!1,showOne:!0,overallSearch:!1});parseInt(a(".naive-accordion").data("open"),10);b.uncollapseRow(0)}(jQuery);
